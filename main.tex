\documentclass[xetex,mathserif,serif,10pt]{beamer}
%\documentclass[11pt]{article}
\usepackage{xltxtra}
\usepackage{polyglossia}
\setdefaultlanguage[spelling=modern]{russian}
%\setmainfont[Mapping=tex-text]{DejaVu Sans}
%\setmainfont[Mapping=tex-text]{Liberation Sans}
\setmonofont[Mapping=tex-text]{DejaVu Sans Mono}
\setmainfont[Mapping=tex-text]{Linux Libertine O}
%\setmonofont[Mapping=tex-text]{Liberation Mono}

\usepackage{verbatim}
\usepackage{tabularx}
\usepackage{float}
\usepackage{url}

\usepackage{indentfirst}

\usepackage{algorithm}
\usepackage{algorithmic}

%\usepackage[a4paper]{geometry}
%\geometry{left=25mm}
%\geometry{right=25mm}
%\geometry{top=25mm}
%\geometry{bottom=15mm}

%\setbeamertemplate{caption}[numbered]

\newcommand{\includepicture}[3]{
\begin{figure}[H]
\begin{center}
\leavevmode
%\large{\textbf{#2}}
\includegraphics[#3]{#1}
\end{center}
\caption{#2}
\end{figure}
}

\usepackage{listings}
\lstset{ %
language=C++,                   % the language of the code
basicstyle=\scriptsize,         % the size of the fonts that are used for the code
numbers=left,                   % where to put the line-numbers
numberstyle=\footnotesize,      % the size of the fonts that are used for the line-numbers
stepnumber=1,                   % the step between two line-numbers. If it's 1, each line 
                                % will be numbered
numbersep=5pt,                  % how far the line-numbers are from the code
%backgroundcolor=\color{white},  % choose the background color. You must add \usepackage{color}
showspaces=false,               % show spaces adding particular underscores
showstringspaces=false,         % underline spaces within strings
showtabs=false,                 % show tabs within strings adding particular underscores
frame=single,                   % adds a frame around the code
tabsize=2,                      % sets default tabsize to 2 spaces
captionpos=b,                   % sets the caption-position to bottom
breaklines=true,                % sets automatic line breaking
breakatwhitespace=false,        % sets if automatic breaks should only happen at whitespace
title=\lstname,                 % show the filename of files included with \lstinputlisting;
                                % also try caption instead of title
escapeinside={\%*}{*)},         % if you want to add a comment within your code
morekeywords={*,...}            % if you want to add more keywords to the set
}

%\usetheme{Warsaw}
\usetheme{Singapore}

\begin{document}
    \title[C++]{C++}
    \author[Филиппов]{А.~Филиппов\inst{1}}
    \institute
    {
        \inst{1}
        Ижевский государственный технический университет имени М.Т.~Калашникова
    }
    \frame{\titlepage}
    \begin{frame}{Содержание}
        \tableofcontents
    \end{frame}
    \section{Модель памяти}
    \begin{frame}{Модель памяти}
        \begin{itemize}
            \item Байт -- основная единица памяти.
            \item Память, доступная для C++, представлена в виде одной или нескольких непрерывных последовательностей байт.
            \item Каждый байт имеет различный адрес.
        \end{itemize}
    \end{frame}
    \section{Объектная модель}
    \subsection{Введение}
    \begin{frame}{Объектная модель}
        \begin{block}{Определение}
            \textbf{Объект} -- область памяти.
        \end{block}
        \begin{block}{Свойства}
            \begin{itemize}
                \item Имя (опционально).
                \item Продолжительность хранения -- storage duration (относится к области памяти, в которой хранится объект).
                \item Время жизни -- lifetime (не превышает storage duration).
                \item Тип.
            \end{itemize}
        \end{block}
    \end{frame}
    \begin{frame}{Объектная модель}
        \begin{block}{Действия}
            \begin{itemize}
                \item Создать объект.
                \item Уничтожить объект.
                \item Указать на объект.
                \item Обращаться к объекту.
                \item Управлять объектами.
            \end{itemize}
        \end{block}
    \end{frame}
    \subsection{Виды объектов}
    \begin{frame}{Виды объектов}
        \begin{itemize}
            \item Subobject
                \begin{itemize}
                    \item объект член другого объекта
                    \item объект базовый класс
                    \item элемент массива
                \end{itemize}
            \item Most-derived object
                \begin{itemize}
                    \item Подкласс любого класса, экземпляром которого является объект, называется most-derived class.
                    \item Объект неклассового типа или класса most-derived class называется most-derived object.
                \end{itemize}
        \end{itemize}
    \end{frame}
    \subsection{Адреса объектов}
    \begin{frame}{Адреса объектов}
        \begin{itemize}
            \item Исключая битовые поля, most-derived object имеет ненулевой размер, занимая при этом 1 или более байт
                пространства памяти.
            \item Исключая битовые поля и объекты базовых классов, адрес объекта -- это адрес первого байта занимаемой им памяти.
            \item Исключая битовые поля, два объекта могут иметь одинаковый адрес, если
                \begin{itemize}
                    \item один является subobject'ом другого
                    \item один из объектов базового класса имеет нулевой размер, и они разного типа
                \end{itemize}
            \item В остальных случаях объекты имеют разный адрес.
        \end{itemize}
    \end{frame}
    \begin{frame}{Примеры}
        \lstinputlisting{examples/address.cpp}
    \end{frame}
    \section{Выполнение программы}
    \subsection{Соответствие стандарту}
    \begin{frame}{Соответствие стандарту}
        \begin{itemize}
            \item Соответствующая стандарту программа должна воспроизводить одинаковое \textit{наблюдаемое} поведение
                на одинаковых входных данных.
            \item Международный стандарт не требует конкретного поведения от программ, не соответствующих ему.
        \end{itemize}
    \end{frame}
    \subsection{Виды «поведения»}
    \begin{frame}{Виды «поведения»}
        \begin{block}{Specified}
            Явно указанные в стандарте. \\
            Пример: $sizeof(char)$.
        \end{block}
        \begin{block}{Implementation defined}
            Зависят от реализации (компилятора, ОС). \\
            Пример: $sizeof(int)$.
        \end{block}
        \begin{block}{Unspecified}
            Стандарт задаёт допустимые рамки поведения. \\
            Пример: последовательность вычисления аргументов функции $f(g(x), h(y))$.
        \end{block}
        \begin{block}{Undefined}
            Стандарт не определяет никаких требований к программам, содержащим undefined~behavior. \\
            Пример: попытка изменить const-объект.
        \end{block}
    \end{frame}
    \subsection{Побочные эффекты}
    \begin{frame}{Побочные эффекты}
        \begin{itemize}
            \item Доступ к объекту volatile glvalue.
            \item Изменение объекта.
            \item Обращение к подсистеме I/O.
            \item Вызов функции, совершающей одну этих операций.
        \end{itemize}
    \end{frame}
    \subsection{Порядок выполнения}
    \subsubsection{Отношение порядка выполнения}
    \begin{frame}{Отношение порядка выполнения}
        \begin{itemize}
            \item «Sequenced before» является бинарным асимметричным и транзитивным отношением.
            \item Если отношение не определено ни для (A, B), ни для (B, A), то A и B unsequenced,
                то есть их порядок их выполнения не определён (в том числе, выполнение может перекрываться).
            \item Операции A и B считаются «indeterminately sequenced», если sequenced либо (A, B), либо (B, A), но не указано которое.
        \end{itemize}
    \end{frame}
    \subsection{Выражение}
    \begin{frame}{Выражение}
        \begin{itemize}
            \item \textit{Full-expression} (полное выражение) -- такое выражение, которое не является подвыражением ни одного другого выражения.
            \item Все побочные эффекты, связанные с вычислением полного выражения, \textit{происходят до} побочных эффектов следующего полного выражения.
            \item Исключая некоторые оговоренные случаи, порядок вычисления операндов отдельных операторов, а так же подвыражений отдельных выражений \textit{не определён}.
            \item Вычисление значений операндов \textit{происходит до} вычисления результата действия оператора.
        \end{itemize}
    \end{frame}
    \begin{frame}{Выражение}
        \begin{itemize}
            \item В выражении, вычисляемом больше одного раза во время работы программы, порядок вычисления его \textit{неупорядоченных} подвыражений может отличаться.
            \item Если порядок побочного эффекта относительно другого побочного эффекта, либо использования этого скаляра не определён, то \textit{поведение не определено}.
            \item Вычисление аргументов функции \textit{происходит до } выполнения тела функции.
            \item Вычисления функций \textit{не пересекаются}.
        \end{itemize}
    \end{frame}
    \begin{frame}{Примеры}
        \lstinputlisting{examples/side_effects1.cpp}
    \end{frame}
    \begin{frame}{Примеры}
        \lstinputlisting{examples/side_effects2.cpp}
    \end{frame}
    % TODO operation sequence
    % TODO 1.10 threads
    % TODO signals

    \section{Сборка}
    \subsection{Раздельная компиляция}
    \subsubsection{Исходный код}
    \begin{frame}{Исходный код}
        \begin{itemize}
            \item Исходный код содержится в единицах, называемыми исходными файлами.
            \item Исходный файл вместе со всеми включенными исходными файлами и заголовочными файлами посредством директивы $"\sharp{include}"$
                за исключением строк, пропущенным директивами условным включением, называется единица трансляции.
        \end{itemize}
    \end{frame}
    \subsection{Фазы трансляции}
    \begin{frame}{Фазы трансляции}
        \begin{itemize}
            \item Реальные символы исходного файла отображаются в базовый набор символов.
                Множество принимаемых символов исходного кода \textit{задаётся реализацией языка}.
            \item Все символы вне базового набора заменяются на universal-character-name $\backslash{uXXXX}$.
            \item Все вхождения обратного слеша, сразу за которым следует символ перевода строки,
                удаляются, а соответствующие строки соединяются в одну. Если в результате появляется
                universal-character-name, \textit{поведение не определено}.
            \item Исходный файл разбивается на токены препроцессора и последовательности
                пробельных символов, включая комментарии. Файл не должен содержать не закрытых комментариев и
                токенов препроцессора.
            \item Подряд идущие строковые литералы конкатенируются.
        \end{itemize}
    \end{frame}
    \begin{frame}{Фазы трансляции}
        \begin{itemize}
            \item Каждый комментарий заменяется одним пробельным символом.
            \item Процесс выделения токенов препроцессора контекстно-зависимый (например, символ в токенах препроцессора).
            \item Выполняются директивы препроцессора, разворачиваются макро-определения, выполняются унарные операторы \_Pragma.
                В случае, если в результате соединения токенов получается universal-character-name, \textit{поведение не определено}.
            \item Директивы $"\sharp{include}"$ запускают рекурсивную обработку указанного файла рекурсивно.
            \item Удаляются все директивы препроцессора.
            \item Происходит синтаксический и семантический анализ.
            \item [Опционально] происходит компановка единиц трансляции в исполняемые файлы либо статические библиотеки.
        \end{itemize}
    \end{frame}
    \section{Самостоятельно}
    \begin{frame}{Самостоятельно}
        \begin{itemize}
            \item Разобрать процесс трансляции для любого (выбранного) компилятора C++.
            \item Рассмотреть типы директив препроцессора.
            \item Изучить (читать \textit{посмотреть на}) ключевые слова языка,
                чтобы иметь представление, какие имена использовать нельзя.
        \end{itemize}
    \end{frame}
    \section{GCC}
    \subsection{Препроцессор}
    \subsubsection{Директивы}
    \subsection{Компилятор}
    \subsubsection{Ключевые слова}
    \subsection{Ассемблер}
    \subsubsection{Объектный файл}
    \subsubsection{Статическая библиотека}
    \subsection{Линкер}
    \subsubsection{Исполняемый файл}
    \subsubsection{Динамическая библиотека}

    %\section{Время жизни объекта}
    % 3.10 value categories
    %\subsection{}
    %\begin{frame}{}
    %\end{frame}
\end{document}
